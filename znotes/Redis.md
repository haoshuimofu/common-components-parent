#Redis
##redis集群什么情况下会不可用
Redis集群可能会在以下情况下不可用：

1. 网络故障：Redis集群可能会因为网络故障导致节点之间的通信失效，进而导致集群不可用。

2. 节点故障：如果Redis集群的某个节点出现故障，例如宕机、重启或者网络中断等，这个节点上的数据将无法访问，可能导致集群不可用。

3. 配置错误：Redis集群的配置必须正确才能正常工作。如果配置出现问题，例如节点的IP地址或端口不正确，将导致集群无法正常工作。

4. 负载过高：当Redis集群的负载过高时，可能会导致节点之间的通信延迟增加，进而导致集群不可用。

5. 安全问题：如果Redis集群的安全机制出现问题，例如未授权的访问或者暴力破解攻击，可能会导致集群不可用。

##redis集群主节点挂了，故障转移时集群可用吗
当Redis集群中的主节点发生故障，Redis提供了自动或手动的故障转移机制来保证集群的可用性，这个过程称为主从切换。

在主节点挂掉的情况下，Redis集群可以通过从节点进行自动或手动的故障转移，将某个从节点提升为新的主节点，以保证集群的可用性。在这个过程中，客户端可能会面临短暂的连接中断或者请求超时，但是一旦故障转移成功，集群就可以继续正常工作了。

需要注意的是，在自动故障转移的情况下，Redis集群中的从节点必须满足一定的条件，例如已经复制了主节点上的所有数据，且与主节点的同步延迟不超过一定的阈值等，才能被选举为新的主节点。否则，故障转移可能会失败，导致集群不可用。因此，为了保证Redis集群的高可用性，建议实现多个从节点，并对节点的配置和同步延迟进行监控和调整。

##redis集群满足CAP中哪些
Redis集群满足CAP中的AP问题（可用性和分区容错性）。在Redis集群中，数据被分布在多个节点上，每个节点都负责一个数据子集。如果一个节点失效，其他节点仍然可以提供数据服务。因此，Redis集群具备高可用性和分区容错性。但是，Redis集群不提供强一致性保证，因为在数据复制过程中可能会存在一定的延迟。

#引申
##分布式CAP
根据CAP定理，分布式系统无法同时满足一致性（Consistency）、可用性（Availability）和分区容错性（Partition Tolerance）这三个要求。

##Zookeeper
1. 在Zookeeper中，它强调了CP模型，即一致性和分区容错性优先。因此，Zookeeper可以提供高度一致性和可靠性，但是在网络分区的情况下会受到影响，可能会导致某些节点无法访问。因此，Zookeeper满足了一致性和分区容错性，但是在可用性方面可能会受到影响。
2. Zookeeper集群中没有主从结构，而是采用了一种称为Quorum的算法来实现分布式一致性。在Zookeeper集群中，每个节点都是相等的，没有主节点和从节点之分。而是通过选举机制来选举出一个节点作为Leader，负责处理客户端请求并维护数据的一致性。其他节点则作为Follower，负责复制Leader的操作并且在Leader失效时选举新的Leader。

在一个Zookeeper集群中，至少需要有3个节点才能够保证高可用性和一致性。当节点数为奇数时，只需要超过半数节点存活，集群就能正常工作；当节点数为偶数时，需要至少一半以上节点存活才能正常工作。因此，在实际应用中，通常会采用3、5、7等奇数个节点来组成Zookeeper集群。